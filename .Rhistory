library(readr)
Divvy_Trips_2019_Q2 <- read_csv("C:/Users/Aisha/Desktop/yasser project/new project for year 2019/Divvy_Trips_2019_Q2.csv",
col_types = cols(`01 - Rental Details Local Start Time` = col_datetime(format = "%m/%d/%Y %H:%M"),
`01 - Rental Details Local End Time` = col_datetime(format = "%m/%d/%Y %H:%M")))
View(Divvy_Trips_2019_Q2)
library(readr)
Divvy_Trips_2019_Q3 <- read_csv("C:/Users/Aisha/Desktop/yasser project/new project for year 2019/Divvy_Trips_2019_Q3.csv")
View(Divvy_Trips_2019_Q3)
library(readr)
Divvy_Trips_2019_Q2 <- read_csv("C:/Users/Aisha/Desktop/yasser project/new project for year 2019/Divvy_Trips_2019_Q2.csv",
col_types = cols(`01 - Rental Details Local Start Time` = col_character()))
View(Divvy_Trips_2019_Q2)
library(readr)
Divvy_Trips_2019_Q3 <- read_csv("C:/Users/Aisha/Desktop/yasser project/new project for year 2019/Divvy_Trips_2019_Q3.csv",
col_types = cols(start_time = col_character(),
end_time = col_character()))
View(Divvy_Trips_2019_Q3)
library(readr)
Divvy_Trips_2019_Q4 <- read_csv("C:/Users/Aisha/Desktop/yasser project/new project for year 2019/Divvy_Trips_2019_Q4.csv",
col_types = cols(start_time = col_character(),
end_time = col_character()))
View(Divvy_Trips_2019_Q4)
library(readr)
Divvy_Trips_2020_Q1 <- read_csv("C:/Users/Aisha/Desktop/yasser project/new project for year 2019/Divvy_Trips_2020_Q1.csv",
col_types = cols(started_at = col_character(),
ended_at = col_character()))
View(Divvy_Trips_2020_Q1)
colnames(Divvy_Trips_2019_Q2)
colnames(Divvy_Trips_2019_Q3)
colnames(Divvy_Trips_2019_Q4)
colnames(Divvy_Trips_2020_Q1)
Divvy_Trips_2019_Q2<-rename(Divvy_Trips_2019_Q2,ride_id="01 - Rental Details Rental ID",rideable_type="01 - Rental Details Bike ID",started_at="01 - Rental Details Local Start Time",ended_at="01 - Rental Details Local End Time",start_station_name="03 - Rental Start Station Name",start_station_id="03 - Rental Start Station ID",end_station_name="02 - Rental End Station Name",end_station_id="02 - Rental End Station ID",member_casual = "User Type")
install.packages("tidyverse")
install.packages("lubridate")
install.packages("ggplot2")
library(tidyverse)
library(lubridate)
library(ggplot2)
Divvy_Trips_2019_Q2<-rename(Divvy_Trips_2019_Q2,ride_id="01 - Rental Details Rental ID",rideable_type="01 - Rental Details Bike ID",started_at="01 - Rental Details Local Start Time",ended_at="01 - Rental Details Local End Time",start_station_name="03 - Rental Start Station Name",start_station_id="03 - Rental Start Station ID",end_station_name="02 - Rental End Station Name",end_station_id="02 - Rental End Station ID",member_casual = "User Type")
Divvy_Trips_2019_Q3<-rename(Divvy_Trips_2019_Q3,ride_id="trip_id",rideable_type="bikeid",started_at="start_time",ended_at="end_time",start_station_name="from_station_name",start_station_id="from_station_id",end_station_name="to_station_name",end_station_id="to_station_id",member_casual="usertype")
Divvy_Trips_2019_Q4<-rename(Divvy_Trips_2019_Q4,ride_id="trip_id",rideable_type="bikeid",started_at="start_time",ended_at="end_time",start_station_name="from_station_name",start_station_id="from_station_id",end_station_name="to_station_name",end_station_id="to_station_id",member_casual="usertype")
str(Divvy_Trips_2019_Q2)
str(Divvy_Trips_2019_Q3)
str(Divvy_Trips_2019_Q4)
str(Divvy_Trips_2020_Q1)
Divvy_Trips_2019_Q4<-mutate(Divvy_Trips_2019_Q4,ride_id=as.character(ride_id)rideable_type=as.character(rideable_type))
Divvy_Trips_2019_Q4<-mutate(Divvy_Trips_2019_Q4,ride_id=as.character(ride_id),rideable_type=as.character(rideable_type))
Divvy_Trips_2019_Q3<-mutate(Divvy_Trips_2019_Q3,ride_id=as.character(ride_id),rideable_type=as.character(rideable_type))
Divvy_Trips_2019_Q2<-mutate(Divvy_Trips_2019_Q2,ride_id=as.character(ride_id),rideable_type=as.character(rideable_type))
all_trips<-bind_rows(Divvy_Trips_2019_Q2,Divvy_Trips_2019_Q3,Divvy_Trips_2019_Q4,Divvy_Trips_2020_Q1)
all_trips <- all_trips %>%select(-c(start_lat, start_lng, end_lat, end_lng, birthyear, gender, "01 - Rental Details Duration In Seconds Uncapped", "05 - Member Details Member Birthday Year", "Member Gender", "tripduration"))
colnames(all_trips)
nrow(all_trips)
dim(all_trips)
head(all_trips)
tail(all_trips)
str(all_trips)
summary(all_trips)
table(all_trips$member_casual)
all_trips <-  all_trips %>%mutate(member_casual = recode(member_casual,"Subscriber" = "member","Customer" = "casual"))
table(all_trips$member_casual)
all_trips$date <- as.Date(all_trips$started_at)
all_trips$month <- format(as.Date(all_trips$date), "%m")
all_trips$day <- format(as.Date(all_trips$date), "%d")
all_trips$year <- format(as.Date(all_trips$date), "%Y")
all_trips$day_of_week <- format(as.Date(all_trips$date), "%A")
all_trips$ride_length <- difftime(all_trips$ended_at,all_trips$started_at)
str(all_trips)
is.factor(all_trips$ride_length)
all_trips$ride_length <- as.numeric(as.character(all_trips$ride_length))
is.numeric(all_trips$ride_length)
View(all_trips)
all_trips$ride_length<-difftime(all_trips$ended_at,all_trips$started_at)
all_trips<-mutate(all_trips,started_at=as_datetime(started_at),ended_at=as_datetime(ended_at))
dplyr::last_dplyr_warnings()
all_trips$ride_length<-difftime(all_trips$ended_at,all_trips$started_at)
str(all_trips)
is.factor(all_trips$ride_length)
all_trips$ride_length <- as.numeric(as.character(all_trips$ride_length))
is.numeric(all_trips$ride_length)
all_trips_v2 <- all_trips[!(all_trips$start_station_name == "HQ QR" | all_trips$ride_length<0),]
mean(all_trips_v2$ride_length)
median(all_trips_v2$ride_length)
max(all_trips_v2$ride_length)
min(all_trips_v2$ride_length)
summary(all_trips_v2$ride_length)
View(all_trips_v2)
aggregate(all_trips_v2$ride_length ~ all_trips_v2$member_casual, FUN = mean)
aggregate(all_trips_v2$ride_length ~ all_trips_v2$member_casual, FUN = median)
aggregate(all_trips_v2$ride_length ~ all_trips_v2$member_casual, FUN = max)
aggregate(all_trips_v2$ride_length ~ all_trips_v2$member_casual, FUN = min)
aggregate(all_trips_v2$ride_length ~ all_trips_v2$member_casual + all_trips_v2$day_of_week, FUN = mean)
all_trips_v2$day_of_week <- ordered(all_trips_v2$day_of_week, levels=c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
aggregate(all_trips_v2$ride_length ~ all_trips_v2$member_casual + all_trips_v2$day_of_week, FUN = mean)
aggregate(all_trips_v2$ride_length ~ all_trips_v2$member_casual + all_trips_v2$day_of_week, FUN = mean)
all_trips_v2<-mutate(all_trips_v2,started_at=as.character(started_at),ended_at=as.character(ended_at))
all_trips$ride_length <- diff(all_trips$ended_at,all_trips$started_at)
all_trips$ride_length <- diff.POSIXt(all_trips$ended_at,all_trips$started_at)
all_trips$ride_length <- difftime(all_trips$ended_at,all_trips$started_at)
is.factor(all_trips$ride_length)
all_trips$ride_length <- as.numeric(as.character(all_trips$ride_length))
is.numeric(all_trips$ride_length)
all_trips_v2 <- all_trips[!(all_trips$start_station_name == "HQ QR" | all_trips$ride_length<0),]
mean(all_trips_v2$ride_length)
summary(all_trips_v2$ride_length)
aggregate(all_trips_v2$ride_length ~ all_trips_v2$member_casual, FUN = mean)
aggregate(all_trips_v2$ride_length ~ all_trips_v2$member_casual, FUN = median)
aggregate(all_trips_v2$ride_length ~ all_trips_v2$member_casual, FUN = max)
aggregate(all_trips_v2$ride_length ~ all_trips_v2$member_casual, FUN = min)
aggregate(all_trips_v2$ride_length ~ all_trips_v2$member_casual + all_trips_v2$day_of_week, FUN = mean)
aggregate(all_trips_v2$ride_length,all_trips_v2$member_casual + all_trips_v2$day_of_week, FUN = mean)
aggregate(all_trips_v2$ride_length ~ all_trips_v2$member_casual, FUN = mean)
aggregate(all_trips_v2$ride_length ~ all_trips_v2$member_casual+all_trips_v2$day_of_week, FUN = mean)
all_trips_v2$day_of_week <- format(as.Date(all_trips$date), "%A")
all_trips_v2$date <- as.Date(all_trips$started_at)
all_trips_v2$day_of_week <- format(as.Date(all_trips_v2$date), "%A")
all_trips_v2$date <- as.Date(all_trips_v2$started_at)
all_trips_v2$month <- format(as.Date(all_trips_v2$date), "%m")
all_trips_v2$day <- format(as.Date(all_trips_v2$date), "%d")
all_trips_v2$year <- format(as.Date(all_trips_v2$date), "%Y")
all_trips_v2$day_of_week <- format(as.Date(all_trips_v2$date), "%A")
all_trips_v2 <- all_trips[!(all_trips$start_station_name == "HQ QR" | all_trips$ride_length<0),]
all_trips_v2$date <- as.Date(all_trips_v2$started_at)
all_trips_v2$month <- format(as.Date(all_trips_v2$date), "%m")
all_trips_v2$day <- format(as.Date(all_trips_v2$date), "%d")
> all_trips_v2$year <- format(as.Date(all_trips_v2$date), "%Y")
all_trips_v2$year <- format(as.Date(all_trips_v2$date), "%Y")
all_trips_v2$day_of_week <- format(as.Date(all_trips_v2$date), "%A")
mean(all_trips_v2$ride_length)
all_trips_v2=na.omit(all_trips_v2)
mean(all_trips_v2$ride_length)
median(all_trips_v2$ride_length)
max(all_trips_v2$ride_length)
min(all_trips_v2$ride_length)
summary(all_trips_v2$ride_length)
aggregate(all_trips_v2$ride_length ~ all_trips_v2$member_casual, FUN = mean)
aggregate(all_trips_v2$ride_length ~ all_trips_v2$member_casual, FUN = median)
aggregate(all_trips_v2$ride_length ~ all_trips_v2$member_casual, FUN = max)
aggregate(all_trips_v2$ride_length ~ all_trips_v2$member_casual, FUN = min)
aggregate(all_trips_v2$ride_length ~ all_trips_v2$member_casual + all_trips_v2$day_of_week, FUN = mean)
all_trips_v2$day_of_week <- ordered(all_trips_v2$day_of_week, levels=c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
aggregate(all_trips_v2$ride_length ~ all_trips_v2$member_casual + all_trips_v2$day_of_week, FUN = mean)
all_trips_v2 %>%mutate(weekday = wday(started_at, label = TRUE)) %>%group_by(member_casual, weekday) %>% summarise(number_of_rides = n() ,average_duration = mean(ride_length)) %>% arrange(member_casual, weekday)%>%ggplot(aes(x = weekday, y = number_of_rides, fill = member_casual))+geom_col(position = "dodge")
all_trips_v2 %>%mutate(weekday = wday(started_at, label = TRUE)) %>% group_by(member_casual, weekday) %>% summarise(number_of_rides = n(),average_duration = mean(ride_length)) %>%arrange(member_casual, weekday)  %>% ggplot(aes(x = weekday, y = average_duration, fill = member_casual)) +  geom_col(position = "dodge")
write.csv(counts, file = '~/Desktop/yasser project/avg_ride_length.csv')
save.image("C:/Users/Aisha/Desktop/yasser project/finished project 1/divvy_project.RData")
counts <- aggregate(all_trips_v2$ride_length ~ all_trips_v2$member_casual + all_trips_v2$day_of_week, FUN = mean)
write.csv(counts, file = 'C:\Users\Aisha\Desktop\avg_ride_length.csv')
write.csv(counts,file = 'C:/Users/Aisha/Desktop/avg_ride_length.csv')
save.image("C:/Users/Aisha/Desktop/yasser project/finished project 1/divvy_xxproject.RData")
